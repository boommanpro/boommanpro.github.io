<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>æµè§ˆå™¨åŒæºç­–ç•¥åŠJSONP | BoomMan</title>
<meta name="description" content="çˆ±ç”Ÿæ´» , çˆ±Coding .....">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.7.2/css/all.css" crossorigin="anonymous">
<link rel="shortcut icon" href="https://boommanpro.cn//favicon.ico?v=1622556322915">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://boommanpro.cn//styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155251589-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155251589-1');
</script>


  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://boommanpro.cn/">
        <img src="https://boommanpro.cn//images/avatar.png?v=1622556322915" class="site-logo">
        <h1 class="site-title">BoomMan</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/BoomManPro" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      çˆ±ç”Ÿæ´» , çˆ±Coding .....
    </div>
    <div class="site-footer">
      Â© CopyRight 2016-2020. æ™‹ICPå¤‡16009994å· | <a class="rss" href="https://boommanpro.cn//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">æµè§ˆå™¨åŒæºç­–ç•¥åŠJSONP</h2>
            <div class="post-date">2020-01-06</div>
            
            <div class="post-content">
              <h2 id="åŒæºç­–ç•¥">åŒæºç­–ç•¥</h2>
<blockquote>
<p>åŒæºç­–ç•¥ï¼ˆSame origin policyï¼‰æ˜¯ä¸€ç§çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œåˆ™æµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½å¯èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚</p>
</blockquote>
<blockquote>
<p>å¯ä»¥è¯´Webæ˜¯æ„å»ºåœ¨åŒæºç­–ç•¥åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæµè§ˆå™¨åªæ˜¯é’ˆå¯¹åŒæºç­–ç•¥çš„ä¸€ç§å®ç°ã€‚</p>
</blockquote>
<p>åŒæºç­–ç•¥ï¼Œå®ƒæ˜¯ç”±<strong>Netscape</strong>æå‡ºçš„ä¸€ä¸ªè‘—åçš„å®‰å…¨ç­–ç•¥ã€‚ç°åœ¨æ‰€æœ‰æ”¯æŒJavaScript çš„æµè§ˆå™¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚æ‰€è°“åŒæºæ˜¯æŒ‡ï¼Œ<strong>åŸŸåï¼Œåè®®ï¼Œç«¯å£ç›¸åŒ</strong>ã€‚</p>
<p>å½“ä¸€ä¸ªæµè§ˆå™¨çš„ä¸¤ä¸ªtabé¡µä¸­åˆ†åˆ«æ‰“å¼€æ¥ ç™¾åº¦å’Œè°·æ­Œçš„é¡µé¢å½“æµè§ˆå™¨çš„ç™¾åº¦tabé¡µæ‰§è¡Œä¸€ä¸ªè„šæœ¬çš„æ—¶å€™ä¼šæ£€æŸ¥è¿™ä¸ªè„šæœ¬æ˜¯å±äºå“ªä¸ªé¡µé¢çš„ï¼Œå³æ£€æŸ¥æ˜¯å¦åŒæºï¼Œåªæœ‰å’Œç™¾åº¦åŒæºçš„è„šæœ¬æ‰ä¼šè¢«æ‰§è¡Œã€‚</p>
<p>å¦‚æœéåŒæºï¼Œé‚£ä¹ˆåœ¨è¯·æ±‚æ•°æ®æ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨æ§åˆ¶å°ä¸­æŠ¥ä¸€ä¸ªå¼‚å¸¸ï¼Œæç¤ºæ‹’ç»è®¿é—®ã€‚</p>
<h4 id="åŒæº">åŒæº</h4>
<p>åŸŸåã€åè®®ã€ç«¯å£ç›¸åŒï¼Œä¹Ÿå°±æ˜¯åœ¨åŒä¸€ä¸ªåŸŸé‡Œã€‚</p>
<h4 id="éåŒæºå—åˆ°çš„é™åˆ¶">éåŒæºå—åˆ°çš„é™åˆ¶</h4>
<ul>
<li>
<p>cookieä¸èƒ½è¯»å– ï¼ˆå¦‚æˆ‘åœ¨è‡ªå·±çš„ç«™ç‚¹æ— æ³•è¯»å–åšå®¢å›­ç”¨æˆ·çš„cookieï¼‰</p>
</li>
<li>
<p>domæ— æ³•è·å¾—</p>
</li>
<li>
<p>ajaxè¯·æ±‚ä¸èƒ½å‘é€</p>
</li>
</ul>
<h2 id="ä»€ä¹ˆæ˜¯æµè§ˆå™¨è·¨åŸŸ">ä»€ä¹ˆæ˜¯æµè§ˆå™¨è·¨åŸŸ</h2>
<p>ä¾‹å¦‚ï¼š</p>
<p>ä¸€ä¸ªåŸŸçš„é¡µé¢å»è¯·æ±‚å¦ä¸€ä¸ªåŸŸçš„èµ„æºï¼›</p>
<p>AåŸŸçš„é¡µé¢å»è¯·æ±‚BåŸŸçš„èµ„æºã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://boommanpro.cn//post-images/1578281955053.png" alt="" loading="lazy"></figure>
<h2 id="jsonpå®ç°è·¨åŸŸ">ğŸ˜€ Jsonpå®ç°è·¨åŸŸ</h2>
<h3 id="jsonpçš„åŸºæœ¬åŸç†">JSONPçš„åŸºæœ¬åŸç†</h3>
<p><strong>åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Œè€Œscriptæ ‡ç­¾çš„srcå±æ€§æ˜¯æ²¡æœ‰è·¨åŸŸçš„é™åˆ¶çš„ã€‚</strong></p>
<p>è¿™æ ·ä¸€æ¥,è¿™ç§è·¨åŸŸæ–¹å¼å°±ä¸<strong>ajax XmlHttpRequest</strong>åè®®æ— å…³äº†ã€‚</p>
<p><strong>JSONPå³JSON with Padding</strong></p>
<p>ç”±äºåŒæºç­–ç•¥çš„é™åˆ¶ï¼ŒXmlHttpRequeståªå…è®¸è¯·æ±‚å½“å‰æºï¼ˆåŸŸåã€åè®®ã€ç«¯å£ï¼‰çš„èµ„æºã€‚</p>
<p>å¦‚æœè¦è¿›è¡Œè·¨åŸŸè¯·æ±‚ï¼Œ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨htmlçš„scriptæ ‡è®°æ¥è¿›è¡Œè·¨åŸŸè¯·æ±‚ï¼Œå¹¶<strong>åœ¨å“åº”ä¸­è¿”å›è¦æ‰§è¡Œçš„scriptä»£ç </strong>ï¼Œå…¶ä¸­å¯ä»¥ç›´æ¥<strong>ä½¿ç”¨JSONä¼ é€’javascriptå¯¹è±¡</strong>ï¼Œè¿™ç§è·¨åŸŸçš„é€šè®¯æ–¹å¼ç§°ä¸ºJSONPã€‚</p>
<blockquote>
<p><strong>JSON æ˜¯ä¸€ç§æ•°æ®æ ¼å¼</strong></p>
<p><strong>JSONP æ˜¯ä¸€ç§æ•°æ®è°ƒç”¨çš„æ–¹å¼</strong></p>
</blockquote>
<h3 id="jsonpçš„æ‰§è¡Œè¿‡ç¨‹">Jsonpçš„æ‰§è¡Œè¿‡ç¨‹</h3>
<p>é¦–å…ˆåœ¨å®¢æˆ·ç«¯æ³¨å†Œä¸€ä¸ªcallback (å¦‚:<strong>'TestJsonpCallback'</strong>), ç„¶åæŠŠcallbackçš„åå­—(å¦‚:testjsonpcallback)ä¼ ç»™æœåŠ¡å™¨ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<p>æœåŠ¡ç«¯å¾—åˆ°callbackçš„æ•°å€¼åï¼Œè¦ç”¨TestJsonpCallback(......)æŠŠå°†è¦è¾“å‡ºçš„jsonå†…å®¹åŒ…æ‹¬èµ·æ¥ï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨ç”Ÿæˆ json æ•°æ®æ‰èƒ½è¢«å®¢æˆ·ç«¯æ­£ç¡®æ¥æ”¶ã€‚<br>
ç„¶åä»¥ javascript è¯­æ³•çš„æ–¹å¼ï¼Œç”Ÿæˆä¸€ä¸ªfunctionï¼Œ function åå­—å°±æ˜¯ä¼ é€’ä¸Šæ¥çš„å‚æ•° 'callback'çš„å€¼ <strong>TestJsonpCallback.</strong></p>
<p>æœ€åå°† <strong>json</strong> æ•°æ®ç›´æ¥ä»¥å…¥å‚çš„æ–¹å¼ï¼Œæ”¾ç½®åˆ° function ä¸­ï¼Œè¿™æ ·å°±ç”Ÿæˆäº†ä¸€æ®µ js è¯­æ³•çš„æ–‡æ¡£ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>
å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œè§£æscriptæ ‡ç­¾ï¼Œå¹¶æ‰§è¡Œè¿”å›çš„ javascript æ–‡æ¡£ï¼Œæ­¤æ—¶javascriptæ–‡æ¡£æ•°æ®ï¼Œä½œä¸ºå‚æ•°ï¼Œ ä¼ å…¥åˆ°äº†å®¢æˆ·ç«¯é¢„å…ˆå®šä¹‰å¥½çš„ callback å‡½æ•°.</p>
<h3 id="try-one-test">Try one test</h3>
<h4 id="indexhtml">index.html</h4>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script src=&quot;/static/jquery-3.4.1.js&quot;&gt;&lt;/script&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;index&lt;/h1&gt;


&lt;p&gt;
    &lt;input type=&quot;button&quot; onclick=&quot;Jsonp1();&quot; value='jsonp1'/&gt;
&lt;/p&gt;

&lt;script&gt;


    function Jsonp1() {
        let url = 'http://127.0.0.1:8088/jsonp/success';
        $.ajax({
            type: 'get',
            dataType: 'jsonp',
            url: url,
            //è¿™ä¸ªæ˜¯åå°æ¥å—çš„å‚æ•°
            jsonp: &quot;jsonpCallback&quot;,
            success: function (res) {
               console.log(res)
            },
            error (err) {
                console.error(err)
            }
        })
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h4 id="spring-boot-web">Spring boot web</h4>
<pre><code class="language-java">package cn.boommanpro.jsonp.controller;

import org.springframework.web.bind.annotation.*;

/**
 * @author wangqimeng
 * @date 2020/1/6 11:16
 */
@RestController
@CrossOrigin(&quot;*&quot;)
@RequestMapping(&quot;jsonp&quot;)
public class JsonpController {

    @GetMapping(&quot;success&quot;)
    public String listByName(@RequestParam String jsonpCallback) {
        return jsonpCallback + &quot;(&quot; + &quot;{\&quot;data\&quot;:\&quot;SUCCESS\&quot;}&quot; + &quot;)&quot;;
    }
}


</code></pre>
<h4 id="yapiæµ‹è¯•ç¼–å†™">Yapiæµ‹è¯•ç¼–å†™</h4>
<pre><code>var cb = params.jsonpCallback;
if (!cb){
    cb = 'callback';
}

var json = {
  &quot;result&quot;: [
    {
      &quot;lng&quot;: &quot;121.542306&quot;,
      &quot;lat&quot;: &quot;29.865646&quot;
    }
  ]
}

var res = JSON.stringify(json);
mockJson = cb + '(' + res + ')';
</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://boommanpro.cn/tag/sDkznJCo8/" class="tag">
                    åç«¯æŠ€æœ¯æ ˆ
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://boommanpro.cn/post/gridea-reference/">
                  <h3 class="post-title">
                    Gridea ä¸ªäººæ­å»ºæ•™ç¨‹
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})


var links = document.links;
 
for (var i = 0, linksLength = links.length; i < linksLength; i++) {
   if (links[i].hostname != window.location.hostname) {
       links[i].target = '_blank';
   } 
}


$(function(){
    //ç»™æ¯ä¸€ä¸²ä»£ç å…ƒç´ å¢åŠ å¤åˆ¶ä»£ç èŠ‚ç‚¹
    let preList = $("code");
    for (let pre of preList) {
        //ç»™æ¯ä¸ªä»£ç å—å¢åŠ ä¸Šâ€œå¤åˆ¶ä»£ç â€æŒ‰é’®
        let btn = $("<span class='btn-pre-copy' onclick='preCopy(this)'>Copy to clipboard</span>");
        btn.prependTo(pre);
    }
});
function preCopy(obj) {
    //æ‰§è¡Œå¤åˆ¶
    let btn = $(obj);
    let pre = btn.parent();
    //ä¸ºäº†å®ç°å¤åˆ¶åŠŸèƒ½ã€‚æ–°å¢ä¸€ä¸ªä¸´æ—¶çš„textareaèŠ‚ç‚¹ã€‚ä½¿ç”¨ä»–æ¥å¤åˆ¶å†…å®¹
    let temp = $("<textarea></textarea>");
    //é¿å…å¤åˆ¶å†…å®¹æ—¶æŠŠæŒ‰é’®æ–‡å­—ä¹Ÿå¤åˆ¶è¿›å»ã€‚å…ˆä¸´æ—¶ç½®ç©º
    btn.text("");
    temp.text(pre.text());
    temp.appendTo(pre);
    temp.select();
    document.execCommand("Copy");
    temp.remove();
    //ä¿®æ”¹æŒ‰é’®å
    btn.text("Copy Success");
    //ä¸€å®šæ—¶é—´åå§æŒ‰é’®åæ”¹å›æ¥
    setTimeout(()=> {
        btn.text("Copy to clipboard");
    },1500);
}


function createImgEventFullScreen() {
        var imgs = $(".post-detail").find("img");
        // console.log(imgs);
        for (var i = 0; i < imgs.length; i++) {
            // $(imgs[i]).click(createCover(imgs[i]));
            imgs[i].onclick = function (e) {
                var src = e.srcElement.currentSrc;
                var _this = $(this);
                console.log(_this);
                createCover(src,_this);
            }
        }
        function createCover(src,_this) {
            // console.log(_this);
            // console.log(src);
            var cover = $("<div id='outerDiv'  style='position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:5;width:100%;height:100%;display:none;'><div id='innerDiv' style='position:absolute;'><img  id='bigImg' style='border:5px solid #fff;' src=''/></div></div>");
            $("#outerDiv").remove();
            $("body").append(cover);
            imgShow("#outerDiv", "#innerDiv", "#bigImg", _this,src);

        }
    }
    function imgShow(outerDiv, innerDiv, bigImg, _this,src) {
        //var src = _this.attr("src"); //è·å–å½“å‰ç‚¹å‡»çš„common-imgå…ƒç´ ä¸­çš„srcå±æ€§
        $(bigImg).attr("src", src); //è®¾ç½®#bigImgå…ƒç´ çš„srcå±æ€§

        /*è·å–å½“å‰ç‚¹å‡»å›¾ç‰‡çš„çœŸå®å¤§å°ï¼Œå¹¶æ˜¾ç¤ºå¼¹å‡ºå±‚åŠå¤§å›¾*/
        $("<img/>").attr("src", src).bind('load',function () {
            var windowW = $(window).width(); //è·å–å½“å‰çª—å£å®½åº¦
            var windowH = $(window).height(); //è·å–å½“å‰çª—å£é«˜åº¦
            var realWidth = this.width; //è·å–å›¾ç‰‡çœŸå®å®½åº¦
            var realHeight = this.height; //è·å–å›¾ç‰‡çœŸå®é«˜åº¦
            var imgWidth, imgHeight;
            var scale = 0.9; //ç¼©æ”¾å°ºå¯¸ï¼Œå½“å›¾ç‰‡çœŸå®å®½åº¦å’Œé«˜åº¦å¤§äºçª—å£å®½åº¦å’Œé«˜åº¦æ—¶è¿›è¡Œç¼©æ”¾

            if (realHeight > windowH * scale) { //åˆ¤æ–­å›¾ç‰‡é«˜åº¦
                imgHeight = windowH * scale; //å¦‚å¤§äºçª—å£é«˜åº¦ï¼Œå›¾ç‰‡é«˜åº¦è¿›è¡Œç¼©æ”¾
                imgWidth = imgHeight / realHeight * realWidth; //ç­‰æ¯”ä¾‹ç¼©æ”¾å®½åº¦
                if (imgWidth > windowW * scale) { //å¦‚å®½åº¦ä»å¤§äºçª—å£å®½åº¦
                    imgWidth = windowW * scale; //å†å¯¹å®½åº¦è¿›è¡Œç¼©æ”¾
                }
            } else if (realWidth > windowW * scale) { //å¦‚å›¾ç‰‡é«˜åº¦åˆé€‚ï¼Œåˆ¤æ–­å›¾ç‰‡å®½åº¦
                imgWidth = windowW * scale; //å¦‚å¤§äºçª—å£å®½åº¦ï¼Œå›¾ç‰‡å®½åº¦è¿›è¡Œç¼©æ”¾
                imgHeight = imgWidth / realWidth * realHeight; //ç­‰æ¯”ä¾‹ç¼©æ”¾é«˜åº¦
            } else { //å¦‚æœå›¾ç‰‡çœŸå®é«˜åº¦å’Œå®½åº¦éƒ½ç¬¦åˆè¦æ±‚ï¼Œé«˜å®½ä¸å˜
                imgWidth = realWidth;
                imgHeight = realHeight;
            }
            $(bigImg).css("width", imgWidth); //ä»¥æœ€ç»ˆçš„å®½åº¦å¯¹å›¾ç‰‡ç¼©æ”¾

            var w = (windowW - imgWidth) / 2; //è®¡ç®—å›¾ç‰‡ä¸çª—å£å·¦è¾¹è·
            var h = (windowH - imgHeight) / 2; //è®¡ç®—å›¾ç‰‡ä¸çª—å£ä¸Šè¾¹è·
            $(innerDiv).css({ "top": h, "left": w }); //è®¾ç½®#innerDivçš„topå’Œleftå±æ€§
            //console.log('****')
            $(outerDiv).fadeIn("fast"); //æ·¡å…¥æ˜¾ç¤º#outerDiv
        });

        $(outerDiv).click(function () { //å†æ¬¡ç‚¹å‡»æ·¡å‡ºæ¶ˆå¤±å¼¹å‡ºå±‚
            $(this).fadeOut("fast");
        });
    }
setTimeout(function () {
        createImgEventFullScreen();
}, 1000)
</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '604203165ca31f355811',
        clientSecret: '28129e87b1c6f330265852bb2ae64931391f8898',
        repo: 'boommanpro.github.io',
        owner: 'BoomManPro',
        admin: ['BoomManPro'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
